<div class="card shadow-sm">
  <div class="card-body">

    <%= form_with model: [:admin, @appointment], local: true do |f| %>

      <% if @appointment.errors.any? %>
        <div class="alert alert-danger">
          <h5>There were errors:</h5>
          <ul>
            <% @appointment.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="row">

        <div class="col-md-6 mb-3">
          <%= f.label :patient_id, "Patient" %>
          <%= f.collection_select :patient_id,
                Patient.includes(:user).all,
                :id,
                ->(p) { "#{p.user.name} #{p.user.last_name} (#{p.user.email})" },
                { prompt: "Select patient" },
                class: "form-select" %>
        </div>

        <div class="col-md-6 mb-3">
          <%= f.label :doctor_id, "Doctor" %>
          <%= f.collection_select :doctor_id,
                Doctor.includes(:user).all,
                :id,
                ->(d) { "#{d.user.name} #{d.user.last_name} - #{d.speciality}" },
                { prompt: "Select doctor" },
                class: "form-select" %>
        </div>

      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <%= f.label :date %>
          <%= f.date_field :date, class: "form-control" %>
        </div>

        <div class="col-md-6 mb-3">
          <%= f.label :hour %>
          <%= f.time_field :hour, class: "form-control" %>
        </div>
      </div>

      <div class="mb-3">
        <%= f.label :reason_for_consultation %>
        <%= f.text_area :reason_for_consultation,
              rows: 2,
              class: "form-control" %>
      </div>

      <div class="mb-3">
        <%= f.label :status %>
        <%= f.select :status,
              Appointment.statuses.keys,
              { prompt: "Select status" },
              class: "form-select" %>
      </div>

      <div class="mt-3">
        <%= f.submit class: "btn btn-primary" %>
        <%= link_to "Cancel", admin_appointments_path,
                    class: "btn btn-secondary ms-2" %>
      </div>

    <% end %>

  </div>
</div>
